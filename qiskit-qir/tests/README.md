# qiskit-qir tests

This README explains how to run the qiskit-qir tests, how to extend them and which test fixtures are currently included that generate Qiskit circuits to test the QIR translation.

## Dependencies

First, install test dependencies.

You can install the `qiskit-qir` package in development mode as described in the [README](../README.md).

The tests run using `pytest`. You can install it as follows:

```bash
pip install pytest
```

## Running the tests

To run the tests, simply run:

```bash
pytest
```

in the `qiskit-qir/` folder.

## Tests

The current tests are defined in [test_qiskit_qir.py](test_qiskit_qir.py) and include:

- Component tests for `visitor` and `QiskitModule` element
- `to_qir`
- `to_qir_bitcode`

The code currently only tests if the code runs with no errors and the generated QIR is not empty. It does not yet include any validation or simulation of the generated QIR.

## Test fixtures

The tests make use of test fixtures that are imported in [conftest.py](conftest.py) from the [test_circuits](test_circuits/__init__.py) package.

To add new test fixtures, use the `@pytest.fixture()` decorator to define a circuit as follows:

```python
@pytest.fixture()
def ghz():
    circuit = QuantumCircuit(4, 3)
    circuit.name = "Qiskit Sample - 3-qubit GHZ circuit"
    circuit.h(0)
    circuit.cx(0, 1)
    circuit.cx(1, 2)
    circuit.measure([0,1,2], [0, 1, 2])

    return circuit
```

Then, make sure to add the fixture to the `import` statement in the [test_circuits](test_circuits/__init__.py) init file. This will run the basic tests defined in [test_qiskit_qir.py](test_qiskit_qir.py).

### Current fixtures (unexhaustive list)

Currently, the `test_circuits` package includes the following test fixtures:

- `ghz`
- `teleport`
- `unroll`

The following autogenerated circuits are included as well and define a random circuit generated with `qiskit.random_circuit`, named `random_nxm` where `n` is the number of qubits and `m` is the circuit depth.

- `random_2x2`
- `random_2x3`
- `random_2x4`
- `random_2x5`
- `random_2x6`
- `random_2x7`
- `random_2x8`
- `random_2x9`
- `random_2x10`
- `random_3x2`
- `random_3x3`
- `random_3x4`
- `random_3x5`
- `random_3x6`
- `random_3x7`
- `random_3x8`
- `random_3x9`
- `random_3x10`
- `random_4x2`
- `random_4x3`
- `random_4x4`
- `random_4x5`
- `random_4x6`
- `random_4x7`
- `random_4x8`
- `random_4x9`
- `random_4x10`
- `random_5x2`
- `random_5x3`
- `random_5x4`
- `random_5x5`
- `random_5x6`
- `random_5x7`
- `random_5x8`
- `random_5x9`
- `random_5x10`
- `random_6x2`
- `random_6x3`
- `random_6x4`
- `random_6x5`
- `random_6x6`
- `random_6x7`
- `random_6x8`
- `random_6x9`
- `random_6x10`
- `random_7x2`
- `random_7x3`
- `random_7x4`
- `random_7x5`
- `random_7x6`
- `random_7x7`
- `random_7x8`
- `random_7x9`
- `random_7x10`
- `random_8x2`
- `random_8x3`
- `random_8x4`
- `random_8x5`
- `random_8x6`
- `random_8x7`
- `random_8x8`
- `random_8x9`
- `random_8x10`
- `random_9x2`
- `random_9x3`
- `random_9x4`
- `random_9x5`
- `random_9x6`
- `random_9x7`
- `random_9x8`
- `random_9x9`
- `random_9x10`
- `random_10x2`
- `random_10x3`
- `random_10x4`
- `random_10x5`
- `random_10x6`
- `random_10x7`
- `random_10x8`
- `random_10x9`
- `random_10x10`
