parameters:
  - name: jslib
    type: string
  - name: projectname
    type: string
  - name: outputDirectory
    type: string
  - name: project
    type: string

steps:
  - task: NodeTool@0
    inputs:
      versionSpec: "16.x"
    displayName: "Install Node.js"


  - task: npmAuthenticate@0
    inputs:
      workingFile: "${{ parameters.jslib }}.npmrc"
    displayName: "npm authenticate"

  # - script: 
  #     npm link react ${{ parameters.projectname }}
  #   workingDirectory: "${{ parameters.jslib  }}"
  #   displayName: "npm link react and quantum visualization to js-lib"

  - script: |
      npm install
      npm run build
    workingDirectory: "${{ parameters.jslib  }}"
    displayName: "npm install and build js-lib"

  - task: CopyFiles@2
    inputs:
      SourceFolder: "${{ parameters.jslib }}/dist"
      Contents: "**"
      TargetFolder: "${{ parameters.outputDirectory }}"
    displayName: "Copy build artifacts to output directory"

